/**
 * Classe Game
 *
 * Classe de controle do game ela chama e controla as classes que executam o game.
 * Esta classe controla as demais.
 *
 **/
import java.util.Arrays;

public class Game{
  
  //Variaveis da classe
  
  //Vetor com os ids das cartas
  static int[] idsCartasJogador;
  static int[] idsCartasComputador;
  
  //Inicia o jogo setando as cartas para os jogadores.
  //As cartas sao referenciadas pelo id cadastrado no arquivo.
  public static void iniciar(int qntdCartas){
    
    //Seta com quantas cartas o jogador escolheu jogar
    Carta.setQuantidadeDeCartas(qntdCartas);
    
    //Pegas as cartas (ids) do jogador e do computador
    Game.idsCartasJogador    = Carta.getCartasJogador();
    Game.idsCartasComputador = Carta.getCartasComputador();
    
    int rodadas = 1;
 
    
    //while(rodadas != 0){
      
      //Variáveis utilizadas para controlar se o jogo continua
      int quantidadeJogador    = (Game.numeroValoresVetor(Game.idsCartasJogador));
      int quantidadeComputador = (Game.numeroValoresVetor(Game.idsCartasComputador));
    
      
      int valorCartaJogador = 0;
      int valorCartaComputador = 0;
      
      //Variavel com a informação de quem começa o game
      //String comeca = sorteiaQuemComeca();
      String comeca = "c";
      
      //Validacao de quem comeca a partida
      if (comeca == "j") {
        
        //Caso a quantidade de cartas do computador seja igual a zero então finaliza o jogo
        if(quantidadeComputador > 0){
          valorCartaComputador = Game.getCartaEscolhidaComputador();
        }else{
          rodadas = 0;
        }
        
      }else{
        
        //Sorteia uma carta computador
        int cartaComputador = sorteiaCartaParaJogar(idsCartasComputador);
        
        //Sorteia uma caracteristica para o Computador
        int caracteristicaComputador = sorteiaCaracteristica();
        
        
        //Caso a quantidade de cartas do jogador seja igual a zero então finaliza o jogo
        if(quantidadeJogador > 0){
          valorCartaJogador = Game.getCartaEscolhidaJogador(cartaComputador,caracteristicaComputador);
        }else{
          rodadas = 0;
        }
        
      }      
      
      //retorna os valores atualizados (placar)
      System.out.println("\n\n Placar \n");
      System.out.println("VOCÊ => "+numeroValoresVetor(idsCartasJogador)
                           +" || PC => "+numeroValoresVetor(idsCartasComputador));
      
     
    //}
    
  }
  
  //Modela os vetores do vencedor e do perdedor da partida
  public static void modelarVetor(int[] idsCartasGanhador,int[] idsCartasPerdedor, int carta){
    
    boolean ocorrencia = true;
    //Coloca na primeira posição vazia do vetor a carta
    for (int j = 0; j < idsCartasGanhador.length; j++) {
      if (idsCartasGanhador[j] == 0) {
        if (ocorrencia) {
          idsCartasGanhador[j] = carta;
          ocorrencia = false;
        }
      }
    }
    
    //Retira a carta do vetor do perdedor
    for (int i = 0; i < idsCartasPerdedor.length; i++) {
      if (idsCartasPerdedor[i] == carta) {
        idsCartasPerdedor[i] = 0;
      }
    }
    
  }
  
  //Controla o fluxo, nesse ponto do programa é controlado a caracteristica que o usuário
  //deve comparar
  public static int getCartaEscolhidaJogador(int cartaComputador, int caracteristicaComputador){
    
    //Sorteia e mostra a carta do jogador
    System.out.println("Esta e sua carta \n");
    int cartaSorteadaJogador = sorteiaCartaParaJogar(idsCartasJogador);
    System.out.println(Leitura.getCartaByString(cartaSorteadaJogador));
    
    //Zera a variavel de caracteristicas
    int caractaristicaJogador = 0;
    
    //Recebe o id da caracteristica a ser comparada
    do{
      Mensagem.printaSelecionaCaracteristica();
      caractaristicaJogador = Entrada.leiaInt();
    }while(caractaristicaJogador <= 0 && caractaristicaJogador > 4);
    
    //Contém os valores das caracteristicas selecionadas
    String valorCaracteristicaJogador   = Game.retornaCaracteristicaSelecionada(caractaristicaJogador,cartaSorteadaJogador); 
    String valorCaracteristicaComputador = Game.retornaCaracteristicaSelecionada(caracteristicaComputador,cartaComputador); 
    
    System.out.println("\n\n Carta do Computador\n");
    System.out.println(Leitura.getCartaByString(cartaComputador));
    
    //Computador venceu
    if (Integer.parseInt(valorCaracteristicaJogador) < 
        Integer.parseInt(valorCaracteristicaComputador)) {
      modelarVetor(idsCartasComputador,idsCartasJogador,cartaSorteadaJogador);
      
      System.out.println("\n\nO Computador venceu essa rodada!\n\n");
      
    //Jogador venceu
    }else{
      modelarVetor(idsCartasJogador,idsCartasComputador,cartaComputador);
      
      System.out.println("\n\nVocê venceu essa rodada!\n\n");
    }
    
    
    
    return 0 ;
  }
  
  public static int getCartaEscolhidaComputador(){
    System.out.println("Esta e sua carta \n");
    System.out.println(Leitura.getCartaByString(idsCartasComputador[0]));
    
    //Zera a variavel de caracteristicas
    int caractaristicaInt = 0;
    
    //Recebe o id da caracteristica a ser comparada
    do{
      Mensagem.printaSelecionaCaracteristica();
      caractaristicaInt = (int)(Math.random() * 5) + 1;
    }while(caractaristicaInt <= 0 && caractaristicaInt > 4);
    
    Game.selecionaCaracteristica(caractaristicaInt,0);
   
    
    System.out.println("Chegou aqui");
    
    //int valor = Integer.parseInt(Game.retornaCaracteristicaSelecionada(caractaristicaInt,idsCartasJogador[0]));
    
    
    return 0 ;
  
  }
  
  public static int sorteiaCaracteristica() {
    return (int) ((Math.random() * 4) + 1);
  }
  
  
  //Faz o sorteio da carta que vai ser jogada
  public static int sorteiaCartaParaJogar(int[] vetor){
  
    boolean existe = false;
    int cartaSorteada = 0;
    
    //Sorteia a carta enquanto ela não existir no vetor passado por parâmetro
    do {
       cartaSorteada = (int) ((Math.random() * 32) + 1);
       
       for (int i = 0; i < vetor.length; i++) {
         if (vetor[i] == cartaSorteada) {
           existe = true;
         }
       }
    }while(existe == false);
    
    return cartaSorteada;
  }
  
  //Metodo usado para sortear quem começa o jogo
  public static String sorteiaQuemComeca(){
    int comeca = (int) (Math.random() * 10) + 1;
    
    if (comeca % 2 == 0) {
      return "c";
    }else{
      return "j";
    }
    
  }
  
  //Funcao retorna quantidade de "casas" da matriz com valor
  //Conta a quantidade de valores dentro do vetor passado por parâmetro
  public static int numeroValoresVetor(int[] numeroValoresVetor){
    
    int cont = 0;
    
    for(int i = 0; i < numeroValoresVetor.length; i++){
      if(numeroValoresVetor[i] >= 1){
        cont++;
      }
    }
  
    return cont;
  }
  
  //Funcao que trabalha com a caracteristica que o usuario selecionou
  public static void selecionaCaracteristica(int caractaristicaInt,int cartaId){
    
   
  }
  
  //Compara a caracteristica que o usu�rio selecionou
  public static void comparaCaracteristica(int caractaristicaInt, int cartaId){
    int valorCaracteristicaUsuario = Integer.parseInt(retornoLeitura.retornaValorCaracteristica(caractaristicaInt,cartaId));
  }
  
  public static String retornaCaracteristicaSelecionada(int caractaristicaInt, int cartaId){
    return retornoLeitura.retornaValorCaracteristica(caractaristicaInt,cartaId);
  }
  
  public static int retornaCaracteristicaDoComputador(){
    return 2;
  }
  
}